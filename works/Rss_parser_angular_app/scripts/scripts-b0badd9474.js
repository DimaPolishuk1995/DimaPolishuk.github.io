"use strict";var rssFeedApp=angular.module("rssFeedApp",["ui.router","ui.router.util","ui.router.compat","xml","ngResource","ngRoute"]);rssFeedApp.config(["$locationProvider","$stateProvider","$urlRouterProvider",function(e,t,s){s.otherwise("/"),t.state("listNews",{url:"/",controller:"ListNewsCtrl",templateUrl:"views/listNews.html"}).state("view-news",{url:"/:id",controller:"ViewNewsCtrl",templateUrl:"views/viewNews.html"})}]),rssFeedApp.controller("ListNewsCtrl",["$scope","$http","$rootScope","FeedService","ArrayService","TimeParse","$sce",function(e,t,s,r,a,u,l){e.feedSrc=r.getUrl(),e.news=a.getArrayNews();var n="https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=100&output=xml&q="+e.feedSrc,c=l.trustAsResourceUrl(n);t.jsonp(c,{callback:"JSON_CALLBACK"}).then(function(t){var s=new X2JS,r=s.xml_str2json(t.data.responseData.xmlString);e.feeds=r.rss.channel.item;for(var a=0,l=e.feeds.length;a<l;a++)e.feeds[a].pubDate=u(e.feeds[a].pubDate)},function(t){e.feeds=t.statusText}),e.loadFeed=function(){r.setUrl(e.feedSrc);var s="https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=100&output=xml&q="+e.feedSrc,a=l.trustAsResourceUrl(s);t.jsonp(a,{callback:"JSON_CALLBACK"}).then(function(t){var s=new X2JS,r=s.xml_str2json(t.data.responseData.xmlString);e.feeds=r.rss.channel.item;for(var a=0,l=e.feeds.length;a<l;a++)e.feeds[a].pubDate=u(e.feeds[a].pubDate)},function(t){e.feeds=t.statusText})}}]),rssFeedApp.controller("ViewNewsCtrl",["$scope","$state","$stateParams","$http","$timeout","$rootScope","FeedService","TimeParse","$sce",function(e,t,s,r,a,u,l,n,c){e.loader=!0,e.feedSrc=l.getUrl();var o="https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=100&output=xml&q="+e.feedSrc,i=c.trustAsResourceUrl(o);a(function(){r.jsonp(i,{callback:"JSON_CALLBACK"}).then(function(t){var r=s.id,a=new X2JS,u=a.xml_str2json(t.data.responseData.xmlString);e.feeds=u.rss.channel.item[r],e.time=n(u.rss.channel.item[r].pubDate),e.content=e.feeds.enclosure._url;for(var l=0,c=e.feeds.length;l<c;l++)e.feeds[l].pubDate=n(e.feeds[l].pubDate)},function(t){e.feeds=t.statusText}),e.loader=!1},1500)}]),rssFeedApp.filter("trusted",["$sce",function(e){return e.trustAsHtml}]),rssFeedApp.factory("TimeParse",function(){return function(e){var t=Date.parse(e);return t}}),rssFeedApp.factory("ArrayService",function(){var e=[{title:"Все новости",url:"https://www.rbc.ua/static/rss/all.rus.rss.xml"},{title:"Главные новости",url:"https://www.rbc.ua/static/rss/ukrnet.strong.rus.rss.xml"},{title:"Политика",url:"https://www.rbc.ua/static/rss/ukrnet.politics.rus.rss.xml"},{title:"Экономика",url:"https://www.rbc.ua/static/rss/ukrnet.economic.rus.rss.xml"},{title:"Происшествия",url:"https://www.rbc.ua/static/rss/ukrnet.accidents.rus.rss.xml"},{title:"Культура",url:"https://www.rbc.ua/static/rss/ukrnet.culture.rus.rss.xml"},{title:"Спорт",url:"https://www.rbc.ua/static/rss/ukrnet.sport.rus.rss.xml"},{title:"Дайджест",url:"https://www.rbc.ua/static/rss/digests.rus.rss.xml"}];return{getArrayNews:function(){return e}}}),rssFeedApp.factory("FeedService",function(){var e="https://www.rbc.ua/static/rss/all.rus.rss.xml";return{setUrl:function(t){e=t},getUrl:function(){return e}}});