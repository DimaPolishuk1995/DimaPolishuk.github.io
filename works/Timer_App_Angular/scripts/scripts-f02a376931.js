"use strict";var trackProcess=angular.module("trackProcess",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ui.bootstrap","ui.router","ngStorage","ngMaterial"]);trackProcess.controller("HomepageCtrl",["$scope","$state","$location","GetArray","LocalStorage","$timeout",function(t,e,r,a,o,n){function s(t,e){var r=0;return t.dateFinish>e.dateFinish&&(r=-1),t.dateFinish<e.dateFinish&&(r=1),r}t.getTasks=o.getTaskToken();var c;t.buttonText="Start",t.tasks=a.getArrayData("tasks"),"undefined"!=typeof t.getTasks&&(t.tasks=t.getTasks),t.project=a.getArrayData("project"),t.currentTask={name:"",selectedProject:"select project",dateFinish:""},t.timer=function(){t.clock=t.dateDifference(t.currentTask.dateBegin,new Date),c=n(t.timer,1e3)},t.startOrStop=function(){void 0==t.currentTask.dateBegin?t.start():t.stop()},t.start=function(){var e=new Date;t.currentTask.dateBegin=e,t.style={background:"rgb(220, 17, 17)"},t.buttonText="Stop",t.timer()},t.stop=function(){var e=new Date;t.currentTask.dateFinish=e,t.tasks.push(t.currentTask),n.cancel(c),t.clock="00:00:00",t.tasks.sort(s),t.currentTask={},t.style={background:"#11dc51"},t.buttonText="Start",o.addTaskToStorage(t.tasks)},t.dateDifference=function(t,e){var r=Math.floor(new Date(e)/1e3)-Math.floor(new Date(t)/1e3),a=r%60;r-=a,r=Math.floor(r/60);var o=r%60;r-=o,r=Math.floor(r/60);var n=r%60;return n<10&&(n="0"+n),o<10&&(o="0"+o),a<10&&(a="0"+a),r=n+":"+o+":"+a},t.quickStart=function(e){void 0!==t.currentTask.dateBegin&&t.stop(),t.start(),t.currentTask.name=e.name,t.currentTask.selectedProject=e.selectedProject},t.removeTask=function(t){o.clearTaskToken(t,t)}}]),trackProcess.config(["$locationProvider","$stateProvider","$urlRouterProvider",function(t,e,r){r.otherwise("/"),e.state("homepage",{url:"/",templateUrl:"views/homepage.html",controller:"HomepageCtrl"})}]),trackProcess.factory("GetArray",function(){var t={tasks:[{name:"Задача № 1",selectedProject:"select project",dateBegin:new Date("07 24, 2016 19:58:49"),dateFinish:new Date("07 24, 2016 19:58:59")},{name:"Задача № 2",selectedProject:"timer",dateBegin:new Date("07 25, 2016 19:58:30"),dateFinish:new Date("07 25, 2016 19:59:15")}],project:[{project:"My project №1"},{project:"My project №2"},{project:"My project №3"}]};return{getArrayData:function(e){return t[e]}}}),trackProcess.service("LocalStorage",["$localStorage",function(t){this.addTaskToStorage=function(e){t.task=e},this.getTaskToken=function(){return t.task},this.clearTaskToken=function(e){var r=e-e+1;t.task.splice(e,r)},this.clearLocalStorage=function(){delete t.task}}]);